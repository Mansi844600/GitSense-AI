<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>GitSense AI Dashboard</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

</head>

<body class="bg-dark text-light">

<div class="container mt-5">

    <h1 class="text-info mb-4">GitSense AI Dashboard</h1>


    <!-- USER INFO -->
    <div class="card bg-secondary p-3 mb-3">
        <h4>{{ user.name if user else "Unknown User" }}</h4>
        <p>Followers: {{ user.followers if user else 0 }}</p>
        <p>Public Repos: {{ user.public_repos if user else 0 }}</p>
    </div>


    <!-- SCORE -->
    <div class="card bg-secondary p-3 mb-3">
        <h4>Portfolio Score</h4>

        <div class="progress">
            <div class="progress-bar bg-info"
                 role="progressbar"
                 style="width: {{ score }}%"
                 aria-valuenow="{{ score }}"
                 aria-valuemin="0"
                 aria-valuemax="100">

                {{ score }}%

            </div>
        </div>
    </div>


    <!-- STRENGTHS -->
    <div class="card bg-success p-3 mb-3">
        <h5>Strengths</h5>

        <ul>
        {% for s in strengths %}
            <li>{{ s }}</li>
        {% else %}
            <li>No strengths found</li>
        {% endfor %}
        </ul>
    </div>


    <!-- RED FLAGS -->
    <div class="card bg-danger p-3 mb-3">
        <h5>Red Flags</h5>

        <ul>
        {% for f in flags %}
            <li>{{ f }}</li>
        {% else %}
            <li>No red flags ðŸŽ‰</li>
        {% endfor %}
        </ul>
    </div>


    <!-- RECOMMENDATIONS -->
    <div class="card bg-warning text-dark p-3 mb-3">
        <h5>Recommendations</h5>

        <ul>
        {% for r in recs %}
            <li>{{ r }}</li>
        {% else %}
            <li>No recommendations yet</li>
        {% endfor %}
        </ul>
    </div>


    <!-- AI ASSISTANT -->
    <div class="card bg-dark p-3 mt-4">
        <h5>AI Assistant</h5>

        <input type="text"
               id="userQuestion"
               class="form-control mb-2"
               placeholder="Ask about this profile...">

        <button class="btn btn-info" onclick="askAI()">
            Ask AI
        </button>

        <p class="mt-3" id="aiReply"></p>
    </div>

</div>


<script>
function askAI() {

    let question = document.getElementById("userQuestion").value;

    fetch("/assistant", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({question: question})
    })
    .then(res => res.json())
    .then(data => {
        document.getElementById("aiReply").innerText = data.reply;
    })
    .catch(() => {
        document.getElementById("aiReply").innerText = "Error contacting AI assistant.";
    });
}
</script>

</body>
</html>
